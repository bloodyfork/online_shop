{% extends "core/main.html" %}
{% load static %}
{% block content %}


<div class="row" id="API-caller">


</div>
{#<div class="row">#}
{#{% for product in products %}#}
{#            <div class="col-lg-4">#}
{#            {% if product.image is not None %}#}
{#                <img class="i" alt='1' src="{{product.image.url}}">#}
{#            {% else %}#}
{#                <img class="i" alt='placeholder' src="{% static 'images/placeholder.png'%}">#}
{#            {% endif %}#}
{#                <div class="box-element product">#}
{#                    <h6><strong>{{ product.name }}</strong></h6>#}
{#                    <hr>#}
{#                    <button class="btn btn-outline-secondary add-btn">Add to Cart</button>#}
{#                    <a class="btn btn-outline-success add-btn" href="{% url 'ProductDetail' pk=product.pk%}">View</a>#}
{#                    <h4 style="display: inline-block; float:right;">${{ product.price }}</h4>#}
{#                </div>#}
{#            </div>#}
{##}
{#{% endfor %}#}
{#</div>#}

    <script type="text/javascript">
        product_list()


        function product_list(){
            var wrapper = document.getElementById('API-caller')
            var  url = 'http://127.0.0.1:8000/product/ProductListAPI/'
            fetch(url)
            .then((resp) => resp.json())
            .then(
                function (data){
                    console.log("Data:",data)

                    var  product =data
                    for (var i of product){

                        var PK = i.id

                        if(
                            i['image'] != null && i['in_stock'] === true
                        ){

                            var item = `


                           <div class="col-lg-4">
                              <img class="i" alt='1' src="${i['image']}">

                              <div class="box-element product">

                                  <h6><strong>${ i.name }</strong></h6>
                                  <h6 style="color: #008000FF"><strong>In Stock</strong></h6>
                                  <hr>
                                  <button class="btn btn-outline-secondary add-btn cart-update">Add to Cart</button>
                                  <a class="btn btn-outline-success add-btn" href="http://127.0.0.1:8000/product/ProductDetail/${PK}">View</a>
                                  <h4 style="display: inline-block; float:right;">$${ i.price }</h4>

                              </div>
                           <div>
                        `
                        wrapper.innerHTML += item}

                    else if(
                         i['image'] != null && i['in_stock'] === false


                    ) {

                         var item = `


                           <div class="col-lg-4">
                              <img class="i" alt='1' src="${i['image']}">

                              <div class="box-element product">

                                  <h6><strong>${ i.name }</strong></h6>
                                  <h6 style='color:#C00101FF'><strong>Out Of Stock</strong></h6>
                                  <hr>
                                  <button class="btn btn-outline-secondary add-btn cart-update">Add to Cart</button>
                                  <a class="btn btn-outline-success add-btn" href="http://127.0.0.1:8000/product/ProductDetail/${PK}">View</a>
                                  <h4 style="display: inline-block; float:right;">$${ i.price }</h4>

                              </div>
                           <div>
                        `
                        wrapper.innerHTML += item}




                    else if(
                         i['image'] === null && i['in_stock'] === true


                    ) {

                         var item = `


                           <div class="col-lg-4">
                              <img class="i" alt='1' src="{% static 'images/placeholder.png' %}">

                              <div class="box-element product">

                                  <h6><strong>${ i.name }</strong></h6>
                                  <h6 style="color: #008000FF"'><strong>In Stock</strong></h6>
                                  <hr>
                                  <button class="btn btn-outline-secondary add-btn cart-update">Add to Cart</button>
                                  <a class="btn btn-outline-success add-btn" href="http://127.0.0.1:8000/product/ProductDetail/${PK}">View</a>
                                  <h4 style="display: inline-block; float:right;">$${ i.price }</h4>

                              </div>
                           <div>
                        `
                        wrapper.innerHTML += item}

                    else{

                         var item = `


                           <div class="col-lg-4">
                              <img class="i" alt='1' src="{% static 'images/placeholder.png' %}">

                              <div class="box-element product">

                                  <h6><strong>${ i.name }</strong></h6>
                                  <h6 style='color:#C00101FF'><strong>Out Of Stock</strong></h6>
                                  <hr>
                                  <button class="btn btn-outline-secondary add-btn cart-update">Add to Cart</button>
                                  <a class="btn btn-outline-success add-btn" href="http://127.0.0.1:8000/product/ProductDetail/${PK}">View</a>
                                  <h4 style="display: inline-block; float:right;">$${ i.price }</h4>

                              </div>
                           <div>
                        `
                        wrapper.innerHTML += item}


                    }
                }
            )
        }


    </script>

    <script src="{% static 'js/cart.js' %}"></script>

{% endblock %}


